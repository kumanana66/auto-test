{"uid":"b19a570e8ab41d10","name":"test_crawler_tasks[case16]","fullName":"tests.test_crawler_tasks#test_crawler_tasks","historyId":"0c93aeb265e2e8f121a536865c615bf4","time":{"start":1753967369245,"stop":1753967369246,"duration":1},"status":"broken","statusMessage":"TypeError: replace() argument 2 must be str, not int","statusTrace":"case = {'case_id': 'task_017', 'expected_code': 200, 'expected_content_type': 'application/vnd.openxmlformats-officedocument.presentationml.presentation', 'headers': {'Authorization': 'Bearer '}, ...}\nauth_token = 'eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbjExNTUiLCJpYXQiOjE3NTM5NjczNjcsImV4cCI6MTc1Mzk3NDU2N30.jIsaUzukKTtbhO9rKcCGYS2LggbhBmAKqATRvS_FPks'\n\n    @allure.feature(\"爬虫任务模块\")\n    @pytest.mark.parametrize(\"case\", CASES)\n    def test_crawler_tasks(case, auth_token):\n        allure.story(case[\"name\"])\n        allure.title(case[\"case_id\"] + \": \" + case[\"name\"])\n    \n        # 替换任务ID占位符\n        if \"{task_id}\" in case[\"url\"]:\n            # 先创建一个测试任务获取ID\n            from utils.context import context\n            if not context.get(\"task_id\"):\n                create_response = Request.send_request(\n                    \"POST\", \"/crawler/tasks\",\n                    json={\n                        \"processName\": \"测试任务\",\n                        \"asinList\": \"B08XJ8J7SZ\",\n                        \"requiredInfo\": [\"price\"],\n                        \"platform\": \"Amazon\",\n                        \"timeCycle\": \"daily\"\n                    },\n                    token=auth_token\n                )\n                context.set(\"task_id\", create_response.json()[\"data\"][\"id\"])\n>           case[\"url\"] = case[\"url\"].replace(\"{task_id}\", context.get(\"task_id\"))\nE           TypeError: replace() argument 2 must be str, not int\n\ntests\\test_crawler_tasks.py:32: TypeError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":3,"retriesStatusChange":false,"beforeStages":[{"name":"auth_token","time":{"start":1753967365307,"stop":1753967367526,"duration":2219},"status":"passed","steps":[{"name":"登录获取token","time":{"start":1753967365307,"stop":1753967367525,"duration":2218},"status":"passed","steps":[{"name":"发送请求：'POST' '/auth/login'","time":{"start":1753967365308,"stop":1753967367525,"duration":2217},"status":"passed","steps":[],"attachments":[{"uid":"90bd2c3a3819bd86","name":"请求信息","source":"90bd2c3a3819bd86.json","type":"application/json","size":64},{"uid":"f61c985fe02df236","name":"响应信息","source":"f61c985fe02df236.txt","type":"text/plain","size":20},{"uid":"6951dd3621d333ba","name":"响应体","source":"6951dd3621d333ba.json","type":"application/json","size":214}],"parameters":[{"name":"method","value":"'POST'"},{"name":"endpoint","value":"'/auth/login'"},{"name":"headers","value":"None"},{"name":"params","value":"None"},{"name":"json","value":"{'username': 'admin1155', 'password': 'admin1155'}"},{"name":"files","value":"None"},{"name":"token","value":"None"}],"attachmentsCount":3,"shouldDisplayMessage":false,"hasContent":true,"attachmentStep":false,"stepsCount":0}],"attachments":[],"parameters":[],"attachmentsCount":3,"shouldDisplayMessage":false,"hasContent":true,"attachmentStep":false,"stepsCount":1}],"attachments":[],"parameters":[],"attachmentsCount":3,"shouldDisplayMessage":false,"hasContent":true,"attachmentStep":false,"stepsCount":2}],"afterStages":[],"labels":[{"name":"feature","value":"爬虫任务模块"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_crawler_tasks"},{"name":"host","value":"CYJ"},{"name":"thread","value":"22888-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_crawler_tasks"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"case","value":"{'case_id': 'task_017', 'name': '下载分析后的PPT', 'method': 'GET', 'url': '/crawler/tasks/{task_id}/analyze/ppt', 'headers': {'Authorization': 'Bearer '}, 'expected_code': 200, 'expected_content_type': 'application/vnd.openxmlformats-officedocument.presentationml.presentation'}"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"fb777c81bdea098a","status":"broken","statusDetails":"KeyError: 'url'","time":{"start":1753967267018,"stop":1753967267018,"duration":0}},{"uid":"bca2a16fc2746d54","status":"broken","statusDetails":"requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8080): Max retries exceeded with url: /api/auth/login (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001657E09DE50>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))","time":{"start":1753967177785,"stop":1753967177785,"duration":0}},{"uid":"581098b7f73fba48","status":"broken","statusDetails":"KeyError: 'url'","time":{"start":1753966888926,"stop":1753966888926,"duration":0}}],"categories":[{"name":"Test defects","matchedStatuses":[]}],"tags":[]},"source":"b19a570e8ab41d10.json","parameterValues":["{'case_id': 'task_017', 'name': '下载分析后的PPT', 'method': 'GET', 'url': '/crawler/tasks/{task_id}/analyze/ppt', 'headers': {'Authorization': 'Bearer '}, 'expected_code': 200, 'expected_content_type': 'application/vnd.openxmlformats-officedocument.presentationml.presentation'}"]}